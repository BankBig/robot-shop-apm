!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){(function(t,n){var r;"undefined"!=typeof self&&self,r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=[].slice;function o(){return"withCredentials"in new window.XMLHttpRequest}for(var a=n(14),s=[],c=0;c<256;++c)s[c]=(c+256).toString(16).substr(1);function u(e,t){var n=t||0,r=s;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")}var f="00",l="00",d="01";var p=n(15);function h(e,t,n,r){return"number"==typeof e&&(e=String(e)),n&&!e&&(e=r||"NA"),e?String(e).substr(0,t):e}var v=["fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd"];function g(e){return null!==e&&"object"===(void 0===e?"undefined":r(e))}function y(e){return"function"==typeof e}e.exports={getPageMetadata:function(){return{page:{referer:document.referrer,url:window.location.href}}},extend:function(e){return this.baseExtend(e,i.call(arguments,1),!1)},merge:function(e){return this.baseExtend(e,i.call(arguments,1),!0)},baseExtend:function e(t,n,r){for(var i=0,o=n.length;i<o;++i){var a=n[i];if(g(a)||y(a))for(var s=Object.keys(a),c=0,u=s.length;c<u;c++){var f=s[c],l=a[f];r&&g(l)?(g(t[f])||(t[f]=Array.isArray(l)?[]:{}),e(t[f],[l],!1)):t[f]=l}}return t},isObject:g,isFunction:y,arrayReduce:function(e,t,n){if(null==e)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var r=Object(e),i=r.length>>>0,o=0;if(!n){for(;o<i&&!(o in r);)o++;if(o>=i)throw new TypeError("Reduce of empty array with no initial value");n=r[o++]}for(;o<i;o++)o in r&&(n=t(n,r[o],o,r));return n},arraySome:function(e,t,n){if(null==e)throw new TypeError("Array.prototype.some called on null or undefined");if("function"!=typeof t)throw new TypeError;var r=Object(e),i=r.length>>>0;n||(n=void 0);for(var o=0;o<i;o++)if(o in r&&t.call(n,r[o],o,r))return!0;return!1},arrayMap:function(e,t,n){var r,i,o;if(null==this)throw new TypeError(" this is null or not defined");var a=Object(e),s=a.length>>>0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(arguments.length>1&&(r=n),i=new Array(s),o=0;o<s;){var c,u;o in a&&(c=a[o],u=t.call(r,c,o,a),i[o]=u),o++}return i},arrayIndexOf:function(e,t,n){var r;if(null==e)throw new TypeError('"arrayVal" is null or not defined');var i=Object(e),o=i.length>>>0;if(0===o)return-1;var a=+n||0;if(Math.abs(a)===1/0&&(a=0),a>=o)return-1;for(r=Math.max(a>=0?a:o-Math.abs(a),0);r<o;){if(r in i&&i[r]===t)return r;r++}return-1},functionBind:function(e,t){var n=Array.prototype.slice.call(arguments,2),r=function(){},i=function(){return e.apply(t,n.concat(Array.prototype.slice.call(arguments)))};return r.prototype=e.prototype,i.prototype=new r,i},getRandomInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},isUndefined:function(e){return void 0===e},isCORSSupported:o,getElasticScript:function(){if("undefined"!=typeof document)for(var e=document.getElementsByTagName("script"),t=0,n=e.length;t<n;t++){var r=e[t];if(r.src.indexOf("elastic")>0)return r}},getCurrentScript:function(){if("undefined"!=typeof document){var e=document.currentScript;return e||this.getElasticScript()}},parseUrl:function(e){var t=/^([^?#]*)(\?([^#]*))?(#(.*))?$/.exec(e),n=t[1]||"",r=t[3]||"",i=t[5]?"#"+t[5]:"",o="";e.indexOf("://")>-1&&(o=e.split("://")[0]+":");for(var a={},s=r.split("&"),c=0,u=s.length;c<u;c++){var f=s[c];if(""!==f&&void 0!==f&&null!==f){var l=s[c].split("=");a[l.shift()]=l.join("=")}}return{protocol:o,path:n,queryString:r,queryStringParsed:a,hash:i}},isPlatformSupported:function(){return"undefined"!=typeof window&&"function"==typeof Array.prototype.forEach&&"function"==typeof JSON.stringify&&"function"==typeof Function.bind&&window.performance&&"function"==typeof window.performance.now&&o()},sanitizeString:h,sanitizeObjectStrings:function e(t,n,i,o){return t?"string"==typeof t?h(t,n,i,o):(Object.keys(t).forEach(function(a){var s=t[a];"string"==typeof s?s=h(t[a],n,i,o):"object"===(void 0===s?"undefined":r(s))&&(s=e(s,n,i,o)),t[a]=s}),t):t},getNavigationTimingMarks:function(){if(window.performance&&window.performance.timing){var e=window.performance.timing,t={},n=e.fetchStart;return v.forEach(function(r){var i=e[r];i&&i>=n&&(t[r]=i-n)}),t}},bytesToHex:u,rng:a,generateRandomId:function(e){return u(a()).substr(0,e)},isSameOrigin:function e(t,n){var r=!1;if("string"==typeof n){var i=new p(t),o=new p(n);r=i.origin===o.origin}else Array.isArray(n)&&n.forEach(function(n){r||(r=e(t,n))});return r},getDtHeaderValue:function(e){if(e&&e.traceId&&e.id){var t=e.sampled?d:l;return f+"-"+e.traceId+"-"+e.id+"-"+t}},isDtHeaderValid:function(e){return/^[\da-f]{2}-[\da-f]{32}-[\da-f]{16}-[\da-f]{2}$/.test(e)&&"00000000000000000000000000000000"!==e.slice(3,35)&&"0000000000000000"!==e.slice(36,52)}}},function(e,t,n){"use strict";function r(){this.subscriptions=[]}r.prototype.subscribe=function(e){var t=this;return this.subscriptions.push(e),function(){var n=t.subscriptions.indexOf(e);n>-1&&t.subscriptions.splice(n,1)}},r.prototype.applyAll=function(e,t){this.subscriptions.forEach(function(n){try{n.apply(e,t)}catch(e){console.log(e,e.stack)}},this)},e.exports=r},function(e,t,n){"use strict";var r=n(9),i=n(18),o=n(23),a=n(0),s=n(3);e.exports={createServiceFactory:function(){var e=new o;return e.registerCoreServices(),r.registerServices(e),i.registerServices(e),e},ServiceFactory:o,patching:s,utils:a}},function(e,t,n){"use strict";var r=n(4).patchXMLHttpRequest,i=new(n(1)),o=!1;e.exports={patchAll:function(){return o||(o=!0,r(function(e,t){i.applyAll(this,[e,t])})),i},subscription:i}},function(e,t,n){"use strict";var r=n(5),i=r.apmSymbol,o=r.patchMethod,a=i("xhrTask"),s=i("xhrListener"),c=i("xhrScheduled"),u=i("xhrSync"),f=i("xhrURL"),l=i("xhrMethod"),d="addEventListener",p="removeEventListener",h=!1,v=i("xhrIgnore");e.exports={patchXMLHttpRequest:function(e){if(!h){h=!0;var t=XMLHttpRequest.prototype,n=t[d],r=t[p];if(!n){var i=window.XMLHttpRequestEventTarget;if(i){var g=i.prototype;n=g[d],r=g[p]}}var y="readystatechange",m="schedule",b="invoke",S="clear",_=o(t,"open",function(){return function(e,t){return e[l]=t[0],e[u]=0==t[2],e[f]=t[1],_.apply(e,t)}}),w=o(t,"send",function(){return function(t,i){var o={source:"XMLHttpRequest.send",state:"",type:"macroTask",ignore:t[v],data:{target:t,method:t[l],sync:t[u],url:t[f],args:i,aborted:!1}},h=function(t){XMLHttpRequest[c]=!1,t.state=m,t.ignore||e(m,t);var i=t.data,o=i.target,u=o[s];n||(n=o[d],r=o[p]),u&&r.call(o,y,u);var f=o[s]=function(){o.readyState===o.DONE&&!i.aborted&&XMLHttpRequest[c]&&t.state===m&&k(t)};n.call(o,y,f),o[a]||(o[a]=t);var l=w.apply(o,i.args);return XMLHttpRequest[c]=!0,l}(o);return t[u]&&k(o),h}}),T=o(t,"abort",function(){return function(t,n){var r=t[a];if(r&&"string"==typeof r.type){if(r.data&&r.data.aborted)return;!function(t){t.state=S,e(S,t),t.data.aborted=!0}(r)}return T.apply(t,n)}})}function k(t){t.state=b,t.ignore||e(b,t)}},XHR_URL:f,XHR_METHOD:l,XHR_IGNORE:v}},function(e,t,n){"use strict";function r(e){return"__apm_symbol__"+e}e.exports={apmSymbol:r,patchMethod:function(e,t,n){var i=e;for(;i&&!i.hasOwnProperty(t);)i=Object.getPrototypeOf(i);!i&&e[t]&&(i=e);var o,a=r(t);if(i&&!(o=i[a])){o=i[a]=i[t];var s=i&&Object.getOwnPropertyDescriptor(i,t);if(function(e){if(!e)return!0;if(!1===e.writable)return!1;return!("function"==typeof e.get&&void 0===e.set)}(s)){var c=n(o,a,t);i[t]=function(){return c(this,arguments)},u=i[t],f=o,u[r("OriginalDelegate")]=f}}var u,f;return o}}},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=n(0),o=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=i.generateRandomId(16);var o=r||{};this.traceId=o.traceId,this.sampled=o.sampled,"function"==typeof o.onSpanEnd?this.onSpanEnd=o.onSpanEnd:this.onSpanEnd=function(){},this.name=t,this.type=n,this.ended=!1,this._end=void 0,this.context=void 0,this._start=window.performance.now()}return r(e,[{key:"end",value:function(){this.ended||(this._end=window.performance.now(),this.ended=!0,this.onSpanEnd(this))}},{key:"duration",value:function(){if(i.isUndefined(this._end)||i.isUndefined(this._start))return null;var e=this._end-this._start;return parseFloat(e)}},{key:"setContext",value:function(e){e&&(this.context=i.merge(this.context||{},e))}}]),e}();e.exports=o},function(e,t,n){"use strict";var r=n(8)(),i=n(2),o=n(32),a=new o(i.createServiceFactory(),!r);"undefined"!=typeof window&&(window.elasticApm=a);var s={__esModule:!0,default:a.init.bind(a),init:a.init.bind(a),ApmBase:o,apmBase:a,apm:a};e.exports=s},function(e,t,n){"use strict";var r=!1,i=!1;e.exports=function(){if(r)return i;r=!0;var e=n(2);return e.utils.isPlatformSupported()?(n(30),e.patching.patchAll(),i=!0):console.log("APM: Platform is not supported!"),i}},function(e,t,n){"use strict";var r=n(10);e.exports={ErrorLogging:r,registerServices:function(e){e.registerServiceCreator("ErrorLogging",function(){var t=e.getService("ApmServer"),n=e.getService("ConfigService"),i=e.getService("LoggingService");return new r(t,n,i)})}}},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=n(11),a=n(0),s=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._apmServer=t,this._configService=n,this._loggingService=r,this._stackTraceService=new o(n,r)}return i(e,[{key:"createErrorDataModel",value:function(e){var t,n=this._stackTraceService.cleanFilePath(e.filename),i=this._stackTraceService.filePathToFileName(n),o=this._stackTraceService.createStackTraces(e);if(o=this._stackTraceService.filterInvalidFrames(o),!i&&o.length){var s=o[o.length-1];i=s.filename?s.filename:"(inline script)"}t=this._stackTraceService.isFileInline(n)?"(inline script)":i;var c=e.message||e.error&&e.error.message,u=e.error?e.error.name:void 0;u||(u=c&&c.indexOf(":")>-1?c.split(":")[0]:"");var f,l=this._configService.get("context"),d=this._configService.get("serverStringLimit");e.error&&"object"===r(e.error)&&(f=this._getErrorProperties(e.error));var p=a.getPageMetadata(),h=a.merge({},p,l,f);return{id:a.generateRandomId(),culprit:a.sanitizeString(t),exception:{message:a.sanitizeString(c,void 0,!0),stacktrace:o,type:a.sanitizeString(u,d,!1)},context:h}}},{key:"logErrorEvent",value:function(e,t){if(this._configService.isActive()){if(void 0===e)return;var n=this.createErrorDataModel(e);if(void 0===n.exception.message)return;return t?this._apmServer.sendErrors([n]):this._apmServer.addError(n)}}},{key:"registerGlobalEventListener",value:function(){var e=this;window.onerror=function(t,n,r,i,o){var a;a=void 0!==t&&"string"!=typeof t?t:{message:t,filename:n,lineno:r,colno:i,error:o},e.logErrorEvent(a)}}},{key:"logError",value:function(e){var t={};return"string"==typeof e?t.message=e:t.error=e,this.logErrorEvent(t)}},{key:"_getErrorProperties",value:function(e){var t={};return Object.keys(e).forEach(function(n){if("stack"!==n){var i=e[n];if(null!==i){switch(void 0===i?"undefined":r(i)){case"function":return;case"object":if("function"!=typeof i.toISOString)return;i=i.toISOString()}t[n]=i}}}),t}}]),e}();e.exports=s},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=n(12),o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._configService=t,this._loggingService=n}return r(e,[{key:"createStackTraces",value:function(e){var t,n=this,r=e.error;if(r)try{t=i.parse(r)}catch(e){this._loggingService.debug("Parsing error stack failed!",e)}return t&&0!==t.length||(t=[{fileName:e.filename,lineNumber:e.lineno,columnNumber:e.colno}]),t=(t=t.map(function(e){return e.functionName&&(e.functionName=(t=e.functionName,n=t.split("/"),t=(t=(t=n.length>1?["Object",n[n.length-1]].join("."):n[0]).replace(/.<$/gi,".<anonymous>")).replace(/^Anonymous function$/,"<anonymous>"),t=(n=t.split(".")).length>1?n[n.length-1]:n[0])),e;var t,n})).map(function(e){if(!e.fileName&&!e.lineNumber)return{};if(!e.columnNumber&&!e.lineNumber)return{};var t=n.cleanFilePath(e.fileName),r=n.filePathToFileName(t);return n.isFileInline(t)&&(r="(inline script)"),{abs_path:e.fileName,filename:r,function:e.functionName||"<anonymous>",lineno:e.lineNumber,colno:e.columnNumber}})}},{key:"filterInvalidFrames",value:function(e){var t=[];return Array.isArray(e)&&(t=e.filter(function(e){return void 0!==e.filename&&void 0!==e.lineno})),t}},{key:"filePathToFileName",value:function(e){var t=window.location.origin||window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");return e.indexOf(t)>-1&&(e=e.replace(t+"/","")),e}},{key:"cleanFilePath",value:function(e){return e||(e=""),"<anonymous>"===e&&(e=""),e}},{key:"isFileInline",value:function(e){return!!e&&0===window.location.href.indexOf(e)}}]),e}();e.exports=o},function(e,t,n){"use strict";var r,i,o,a;"function"==typeof Symbol&&Symbol.iterator;a=function(e){var t=/(^|@)\S+\:\d+/,n=/^\s*at .*(\S+\:\d+|\(native\))/m,r=/^(eval@)?(\[native code\])?$/;function i(e,t,n){if("function"==typeof Array.prototype.map)return e.map(t,n);for(var r=new Array(e.length),i=0;i<e.length;i++)r[i]=t.call(n,e[i]);return r}function o(e,t,n){if("function"==typeof Array.prototype.filter)return e.filter(t,n);for(var r=[],i=0;i<e.length;i++)t.call(n,e[i])&&r.push(e[i]);return r}return{parse:function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(n))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var t=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/.exec(e.replace(/[\(\)]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(t){return i(o(t.stack.split("\n"),function(e){return!!e.match(n)},this),function(t){t.indexOf("(eval ")>-1&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var n=t.replace(/^\s+/,"").replace(/\(eval code/g,"(").split(/\s+/).slice(1),r=this.extractLocation(n.pop()),i=n.join(" ")||void 0,o=function(e,t){if("function"==typeof Array.prototype.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}(["eval","<anonymous>"],r[0])>-1?void 0:r[0];return new e(i,void 0,o,r[1],r[2],t)},this)},parseFFOrSafari:function(t){return i(o(t.stack.split("\n"),function(e){return!e.match(r)},this),function(t){if(t.indexOf(" > eval")>-1&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),-1===t.indexOf("@")&&-1===t.indexOf(":"))return new e(t);var n=t.split("@"),r=this.extractLocation(n.pop()),i=n.join("@")||void 0;return new e(i,void 0,r[0],r[1],r[2],t)},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(t){for(var n=/Line (\d+).*script (?:in )?(\S+)/i,r=t.message.split("\n"),i=[],o=2,a=r.length;o<a;o+=2){var s=n.exec(r[o]);s&&i.push(new e(void 0,void 0,s[2],s[1],void 0,r[o]))}return i},parseOpera10:function(t){for(var n=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=t.stacktrace.split("\n"),i=[],o=0,a=r.length;o<a;o+=2){var s=n.exec(r[o]);s&&i.push(new e(s[3]||void 0,void 0,s[2],s[1],void 0,r[o]))}return i},parseOpera11:function(n){return i(o(n.stack.split("\n"),function(e){return!!e.match(t)&&!e.match(/^Error created at/)},this),function(t){var n,r=t.split("@"),i=this.extractLocation(r.pop()),o=r.shift()||"",a=o.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0;o.match(/\(([^\)]*)\)/)&&(n=o.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var s=void 0===n||"[arguments not available]"===n?void 0:n.split(",");return new e(a,s,i[0],i[1],i[2],t)},this)}}},i=[n(13)],void 0===(o="function"==typeof(r=a)?r.apply(t,i):r)||(e.exports=o)},function(e,t,n){"use strict";var r,i,o;"function"==typeof Symbol&&Symbol.iterator;i=[],void 0===(o="function"==typeof(r=function(){function e(e){return!isNaN(parseFloat(e))&&isFinite(e)}function t(e,t,n,r,i,o){void 0!==e&&this.setFunctionName(e),void 0!==t&&this.setArgs(t),void 0!==n&&this.setFileName(n),void 0!==r&&this.setLineNumber(r),void 0!==i&&this.setColumnNumber(i),void 0!==o&&this.setSource(o)}return t.prototype={getFunctionName:function(){return this.functionName},setFunctionName:function(e){this.functionName=String(e)},getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Args must be an Array");this.args=e},getFileName:function(){return this.fileName},setFileName:function(e){this.fileName=String(e)},getLineNumber:function(){return this.lineNumber},setLineNumber:function(t){if(!e(t))throw new TypeError("Line Number must be a Number");this.lineNumber=Number(t)},getColumnNumber:function(){return this.columnNumber},setColumnNumber:function(t){if(!e(t))throw new TypeError("Column Number must be a Number");this.columnNumber=Number(t)},getSource:function(){return this.source},setSource:function(e){this.source=String(e)},toString:function(){return(this.getFunctionName()||"{anonymous}")+("("+(this.getArgs()||[]).join(",")+")")+(this.getFileName()?"@"+this.getFileName():"")+(e(this.getLineNumber())?":"+this.getLineNumber():"")+(e(this.getColumnNumber())?":"+this.getColumnNumber():"")}},t})?r.apply(t,i):r)||(e.exports=o)},function(e,t,n){"use strict";var r="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(r){var i=new Uint8Array(16);e.exports=function(){return r(i),i}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,n,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=r(16),a=r(17),s=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,c=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,u=[["#","hash"],["?","query"],function(e){return e.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],f={hash:1,query:1};function l(e){var n,r=t&&t.location||{},o={},a=void 0===(e=e||r)?"undefined":i(e);if("blob:"===e.protocol)o=new p(unescape(e.pathname),{});else if("string"===a)for(n in o=new p(e,{}),f)delete o[n];else if("object"===a){for(n in e)n in f||(o[n]=e[n]);void 0===o.slashes&&(o.slashes=c.test(e.href))}return o}function d(e){var t=s.exec(e);return{protocol:t[1]?t[1].toLowerCase():"",slashes:!!t[2],rest:t[3]}}function p(e,t,n){if(!(this instanceof p))return new p(e,t,n);var r,s,c,f,h,v,g=u.slice(),y=void 0===t?"undefined":i(t),m=this,b=0;for("object"!==y&&"string"!==y&&(n=t,t=null),n&&"function"!=typeof n&&(n=a.parse),t=l(t),r=!(s=d(e||"")).protocol&&!s.slashes,m.slashes=s.slashes||r&&t.slashes,m.protocol=s.protocol||t.protocol||"",e=s.rest,s.slashes||(g[3]=[/(.*)/,"pathname"]);b<g.length;b++)"function"!=typeof(f=g[b])?(c=f[0],v=f[1],c!=c?m[v]=e:"string"==typeof c?~(h=e.indexOf(c))&&("number"==typeof f[2]?(m[v]=e.slice(0,h),e=e.slice(h+f[2])):(m[v]=e.slice(h),e=e.slice(0,h))):(h=c.exec(e))&&(m[v]=h[1],e=e.slice(0,h.index)),m[v]=m[v]||r&&f[3]&&t[v]||"",f[4]&&(m[v]=m[v].toLowerCase())):e=f(e);n&&(m.query=n(m.query)),r&&t.slashes&&"/"!==m.pathname.charAt(0)&&(""!==m.pathname||""!==t.pathname)&&(m.pathname=function(e,t){for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,i=n[r-1],o=!1,a=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),a++):a&&(0===r&&(o=!0),n.splice(r,1),a--);return o&&n.unshift(""),"."!==i&&".."!==i||n.push(""),n.join("/")}(m.pathname,t.pathname)),o(m.port,m.protocol)||(m.host=m.hostname,m.port=""),m.username=m.password="",m.auth&&(f=m.auth.split(":"),m.username=f[0]||"",m.password=f[1]||""),m.origin=m.protocol&&m.host&&"file:"!==m.protocol?m.protocol+"//"+m.host:"null",m.href=m.toString()}p.prototype={set:function(e,t,n){var r=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||a.parse)(t)),r[e]=t;break;case"port":r[e]=t,o(t,r.protocol)?t&&(r.host=r.hostname+":"+t):(r.host=r.hostname,r[e]="");break;case"hostname":r[e]=t,r.port&&(t+=":"+r.port),r.host=t;break;case"host":r[e]=t,/:\d+$/.test(t)?(t=t.split(":"),r.port=t.pop(),r.hostname=t.join(":")):(r.hostname=t,r.port="");break;case"protocol":r.protocol=t.toLowerCase(),r.slashes=!n;break;case"pathname":case"hash":if(t){var i="pathname"===e?"/":"#";r[e]=t.charAt(0)!==i?i+t:t}else r[e]=t;break;default:r[e]=t}for(var s=0;s<u.length;s++){var c=u[s];c[4]&&(r[c[1]]=r[c[1]].toLowerCase())}return r.origin=r.protocol&&r.host&&"file:"!==r.protocol?r.protocol+"//"+r.host:"null",r.href=r.toString(),r},toString:function(e){e&&"function"==typeof e||(e=a.stringify);var t,n=this,r=n.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var o=r+(n.slashes?"//":"");return n.username&&(o+=n.username,n.password&&(o+=":"+n.password),o+="@"),o+=n.host+n.pathname,(t="object"===i(n.query)?e(n.query):n.query)&&(o+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(o+=n.hash),o}},p.extractProtocol=d,p.location=l,p.qs=a,e.exports=p},function(e,t,n){"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},function(e,t,n){"use strict";var r,i=Object.prototype.hasOwnProperty;function o(e){return decodeURIComponent(e.replace(/\+/g," "))}t.stringify=function(e,t){t=t||"";var n,o,a=[];for(o in"string"!=typeof t&&(t="?"),e)i.call(e,o)&&((n=e[o])||null!==n&&n!==r&&!isNaN(n)||(n=""),a.push(encodeURIComponent(o)+"="+encodeURIComponent(n)));return a.length?t+a.join("&"):""},t.parse=function(e){for(var t,n=/([^=?&]+)=?([^&]*)/g,r={};t=n.exec(e);){var i=o(t[1]),a=o(t[2]);i in r||(r[i]=a)}return r}},function(e,t,n){"use strict";var r=n(19),i=n(20);e.exports={PerformanceMonitoring:r,registerServices:function(e){e.registerServiceCreator("TransactionService",function(){var t=e.getService("ConfigService"),n=e.getService("LoggingService");return new i(n,t)}),e.registerServiceCreator("PerformanceMonitoring",function(){var t=e.getService("ConfigService"),n=e.getService("LoggingService"),i=e.getService("ApmServer"),o=e.getService("TransactionService");return new r(i,t,n,void 0,o)})}}},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=n(0),o=n(3).subscription,a=function(){function e(t,n,r,i,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._apmServer=t,this._configService=n,this._logginService=r,this._zoneService=i,this._transactionService=o}return r(e,[{key:"init",value:function(){this._zoneService&&this._zoneService.initialize(window.Zone.current);var e=this;this._transactionService.subscribe(function(t){var n=e.createTransactionPayload(t);n&&e._apmServer.addTransaction(n)});var t=this.getXhrPatchSubFn(this._configService,this._transactionService);this.cancelPatchSub=o.subscribe(t)}},{key:"getXhrPatchSubFn",value:function(){var e=this._configService,t=this._transactionService;return function(n,r){if("schedule"===n&&"XMLHttpRequest.send"===r.source&&r.data){var o=r.data.method+" "+r.data.url,a=t.startSpan(o,"ext.HttpRequest");if(a){var s=e.get("distributedTracing"),c=e.get("distributedTracingOrigins"),u=i.isSameOrigin(r.data.url,window.location.href)||i.isSameOrigin(r.data.url,c),f=r.data.target;if(s&&u&&f){var l=e.get("distributedTracingHeaderName"),d=e.get("distributedTracingHeaderValueCallback");"function"!=typeof d&&(d=i.getDtHeaderValue);var p=d(a),h=i.isDtHeaderValid(p);l&&p&&h&&f.setRequestHeader(l,p)}a.setContext({http:{method:r.data.method,url:r.data.url}}),a.sync=r.data.sync,r.data.span=a}}else"invoke"===n&&r.data&&r.data.span&&(r.data.span.setContext({http:{status_code:r.data.target.status}}),r.data.span.end())}}},{key:"setTransactionContextInfo",value:function(e){var t=this._configService.get("context");t&&e.addContextInfo(t)}},{key:"filterTransaction",value:function(e){var t=this._configService.get("transactionDurationThreshold"),n=e.duration();if(!n||n>t||!e.spans.length||!e.sampled)return!1;var r=this._configService.get("browserResponsivenessInterval");if(this._configService.get("checkBrowserResponsiveness")&&!e.isHardNavigation){var i=this._configService.get("browserResponsivenessBuffer");if(!this.checkBrowserResponsiveness(e,r,i))return this._logginService.debug("Transaction was discarded! browser was not responsive enough during the transaction."," duration:",n," browserResponsivenessCounter:",e.browserResponsivenessCounter,"interval:",r),!1}return!0}},{key:"prepareTransaction",value:function(e){if(e.spans.sort(function(e,t){return e._start-t._start}),this._configService.get("groupSimilarSpans")){var t=this._configService.get("similarSpanThreshold");e.spans=this.groupSmallContinuouslySimilarSpans(e,t)}e.spans=e.spans.filter(function(t){return t.duration()>0&&t._start>=e._rootSpan._start&&t._end>e._rootSpan._start&&t._start<e._rootSpan._end&&t._end<=e._rootSpan._end}),this.setTransactionContextInfo(e)}},{key:"createTransactionDataModel",value:function(e){var t=this._configService.get("context"),n=this._configService.get("serverStringLimit"),r=e._rootSpan._start,o=e.spans.map(function(t){var o;return t.context&&(o=i.sanitizeObjectStrings(t.context,n)),{id:t.id,transaction_id:e.id,parent_id:t.parentId||e.id,trace_id:e.traceId,name:i.sanitizeString(t.name,n,!0),type:i.sanitizeString(t.type,n,!0),start:t._start-r,duration:t.duration(),context:o}}),a=i.merge({},t,e.contextInfo);return{id:e.id,trace_id:e.traceId,timestamp:e.timestamp,name:i.sanitizeString(e.name,n,!1),type:i.sanitizeString(e.type,n,!0),duration:e.duration(),spans:o,context:a,marks:e.marks,span_count:{started:o.length},sampled:e.sampled}}},{key:"createTransactionPayload",value:function(e){if(this.prepareTransaction(e),this.filterTransaction(e))return this.createTransactionDataModel(e)}},{key:"sendTransactions",value:function(e){var t=e.map(this.createTransactionPayload.bind(this)).filter(function(e){return e});return this._logginService.debug("Sending Transactions to apm server.",e.length),this._apmServer.sendTransactions(t)}},{key:"convertTransactionsToServerModel",value:function(e){return e.map(this.createTransactionDataModel.bind(this))}},{key:"groupSmallContinuouslySimilarSpans",value:function(e,t){var n=e.duration(),r=[],i=1;return e.spans.forEach(function(o,a){if(0===r.length)r.push(o);else{var s=r[r.length-1],c=s.type===o.type&&s.name===o.name&&o.duration()/n<t&&(o._start-s._end)/n<t,u=e.spans.length===a+1;c&&(i++,s._end=o._end),i>1&&(!c||u)&&(s.name=i+"x "+s.name,i=1),c||r.push(o)}}),r}},{key:"checkBrowserResponsiveness",value:function(e,t,n){var r=e.browserResponsivenessCounter;if(void 0===t||void 0===r)return!0;var i=e.duration();return r+n>=Math.floor(i/t)}}]),e}();e.exports=a},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=n(21),o=n(0),a=n(1),s=n(22).captureHardNavigation,c=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._config=n,void 0===n&&t.debug("TransactionService: config is not provided"),this._logger=t,this.marks={},this.currentTransaction=void 0,this._subscription=new a,this._alreadyCapturedPageLoad=!1}return r(e,[{key:"shouldCreateTransaction",value:function(){return this._config.isActive()}},{key:"getOrCreateCurrentTransaction",value:function(){if(this.shouldCreateTransaction()){var e=this.getCurrentTransaction();return o.isUndefined(e)||e.ended?this.createZoneTransaction():e}}},{key:"getCurrentTransaction",value:function(){return this.currentTransaction}},{key:"setCurrentTransaction",value:function(e){this.currentTransaction=e}},{key:"createTransaction",value:function(e,t,n){var r=n;if(o.isUndefined(r)&&(r=this._config.config),this.shouldCreateTransaction()){var a=new i(e,t,r,this._logger);return this.setCurrentTransaction(a),r.checkBrowserResponsiveness&&this.startCounter(a),a}}},{key:"createZoneTransaction",value:function(){return this.createTransaction("ZoneTransaction","transaction")}},{key:"startCounter",value:function(e){e.browserResponsivenessCounter=0;var t=this._config.get("browserResponsivenessInterval");void 0!==t?this.runOuter(function(){var n=setInterval(function(){e.ended?window.clearInterval(n):e.browserResponsivenessCounter++},t)}):this._logger.debug("browserResponsivenessInterval is undefined!")}},{key:"sendPageLoadMetrics",value:function(e){var t=this.startTransaction(e,"page-load");return t.detectFinish(),t}},{key:"capturePageLoadMetrics",value:function(e){if(this._config.get("capturePageLoad")&&!this._alreadyCapturedPageLoad&&e.isHardNavigation)return e.addMarks(this.marks),s(e),this._alreadyCapturedPageLoad=!0,!0}},{key:"startTransaction",value:function(e,t){var n=this,r=n._config.config;t||(t="custom"),e||(e="Unknown");var i=this.getOrCreateCurrentTransaction();if(i)return"ZoneTransaction"===i.name?i.redefine(e,t,r):(this.logInTransaction("ElasticEnding early to start a new transaction:",e,t),this._logger.debug("Ending old transaction",i),i.end(),i=this.createTransaction(e,t,r)),"page-load"===t&&(i.isHardNavigation=!0,r.pageLoadTraceId&&(i.traceId=r.pageLoadTraceId),void 0!==r.pageLoadSampled&&(i.sampled=r.pageLoadSampled),"Unknown"===i.name&&n._config.config.pageLoadTransactionName&&(i.name=n._config.config.pageLoadTransactionName)),this._logger.debug("TransactionService.startTransaction",i),i.doneCallback=function(){n.applyAsync(function(){(n._logger.debug("TransactionService transaction finished",i),n.shouldIgnoreTransaction(i.name))||("page-load"===t?("Unknown"===i.name&&n._config.config.pageLoadTransactionName&&(i.name=n._config.config.pageLoadTransactionName),n.capturePageLoadMetrics(i)&&n.add(i)):n.add(i))})},i}},{key:"applyAsync",value:function(e,t,n){return this.runOuter(function(){return Promise.resolve().then(function(){return e.apply(t,n)},function(e){console.log(e)})})}},{key:"shouldIgnoreTransaction",value:function(e){for(var t=this._config.get("ignoreTransactions"),n=0;n<t.length;n++){var r=t[n];if("function"==typeof r.test){if(r.test(e))return!0}else if(r===e)return!0}return!1}},{key:"startSpan",value:function(e,t){var n=this.getOrCreateCurrentTransaction();if(n)return this._logger.debug("TransactionService.startSpan",e,t),n.startSpan(e,t)}},{key:"add",value:function(e){this._config.isActive()&&(this._subscription.applyAll(this,[e]),this._logger.debug("TransactionService.add",e))}},{key:"subscribe",value:function(e){return this._subscription.subscribe(e)}},{key:"addTask",value:function(e){var t=this.getOrCreateCurrentTransaction();return t&&(t.addTask(e),this._logger.debug("TransactionService.addTask",e)),e}},{key:"removeTask",value:function(e){var t=this.getCurrentTransaction();o.isUndefined(t)||t.ended||(t.removeTask(e),this._logger.debug("TransactionService.removeTask",e))}},{key:"logInTransaction",value:function(){var e=this.getCurrentTransaction();o.isUndefined(e)||e.ended||e.debugLog.apply(e,arguments)}},{key:"setDebugDataOnTransaction",value:function(e,t){var n=this.getCurrentTransaction();o.isUndefined(n)||n.ended||n.setDebugData(e,t)}},{key:"detectFinish",value:function(){var e=this.getCurrentTransaction();o.isUndefined(e)||e.ended||(e.detectFinish(),this._logger.debug("TransactionService.detectFinish"))}},{key:"runOuter",value:function(e,t,n){return e.apply(t,n)}}]),e}();e.exports=c},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=n(6),o=n(0),a=function(){function e(t,n,r,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=o.generateRandomId(16),this.traceId=o.generateRandomId(),this.timestamp=void 0,this.name=t,this.type=n,this.ended=!1,this._isDone=!1,this._logger=a,this._options=r||{},this.contextInfo={},this.marks=void 0,this._options.sendVerboseDebugInfo&&this.debugLog("Transaction",t,n),this.spans=[],this._activeSpans={},this._scheduledTasks={},this.doneCallback=function(){},this._rootSpan=new i("transaction","transaction"),this.duration=this._rootSpan.duration.bind(this._rootSpan),this.nextAutoTaskId=0,this.isHardNavigation=!1,this.sampled=Math.random()<=this._options.transactionSampleRate}return r(e,[{key:"debugLog",value:function(){if(this._options.sendVerboseDebugInfo){this.contextInfo._debug||(this.contextInfo._debug={log:[]}),this.contextInfo._debug.log||(this.contextInfo._debug.log=[]);var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);e.unshift(Date.now().toString());var t=e.join(" - ");this.contextInfo._debug.log.push(t),this._logger&&this._logger.debug(t)}}},{key:"addContextInfo",value:function(e){o.merge(this.contextInfo,e)}},{key:"setDebugData",value:function(e,t){this.contextInfo._debug||(this.contextInfo._debug={}),this.contextInfo._debug[e]=t}},{key:"addNavigationTimingMarks",value:function(){var e=o.getNavigationTimingMarks();if(e){var t={timeToFirstByte:e.responseStart,domInteractive:e.domInteractive,domComplete:e.domComplete};this.addMarks({navigationTiming:e,agent:t})}}},{key:"addMarks",value:function(e){this.marks=o.merge(this.marks||{},e)}},{key:"mark",value:function(e){var t=e.replace(/[.*]/g,"_"),n=window.performance.now()-this._rootSpan._start,r={};r[t]=n,this.addMarks({custom:r})}},{key:"redefine",value:function(e,t,n){this.debugLog("redefine",e,t),this.name=e,this.type=t,this._options=n}},{key:"startSpan",value:function(e,t,n){if(!this.ended){var r=this;this.debugLog("startSpan",e,t);var o=void 0===n?{}:n;o.onSpanEnd=function(e){r._onSpanEnd(e)},o.traceId=this.traceId,o.sampled=this.sampled;var a=new i(e,t,o);return this._activeSpans[a.id]=a,a}}},{key:"isFinished",value:function(){return 0===Object.keys(this._scheduledTasks).length}},{key:"detectFinish",value:function(){this.isFinished()&&this.end()}},{key:"end",value:function(){if(!this.ended){for(var e in this.debugLog("end"),this.ended=!0,this._activeSpans){var t=this._activeSpans[e];t.type=t.type+".truncated",t.end()}var n=o.getPageMetadata();this.addContextInfo(n),this._rootSpan.end(),this._adjustStartToEarliestSpan(),this._adjustEndToLatestSpan(),this.doneCallback(this)}}},{key:"addTask",value:function(e){return void 0===e&&(e="autoId"+this.nextAutoTaskId++),this.debugLog("addTask",e),this._scheduledTasks[e]=e,e}},{key:"removeTask",value:function(e){this.debugLog("removeTask",e),this.setDebugData("lastRemovedTask",e),delete this._scheduledTasks[e],this.detectFinish()}},{key:"addEndedSpans",value:function(e){this.spans=this.spans.concat(e)}},{key:"_onSpanEnd",value:function(e){this.spans.push(e),e._scheduledTasks=Object.keys(this._scheduledTasks),delete this._activeSpans[e.id]}},{key:"_adjustEndToLatestSpan",value:function(){var e=function(e){for(var t=null,n=0;n<e.length;n++){var r=e[n];r.type&&-1===r.type.indexOf("ext")&&"transaction"!==r.type&&(!t||t._end<r._end)&&(t=r)}return t}(this.spans);if(e){this._rootSpan._end=e._end;for(var t=0;t<this.spans.length;t++){var n=this.spans[t];n._end>this._rootSpan._end&&(n._end=this._rootSpan._end,n.type=n.type+".truncated"),n._start>this._rootSpan._end&&(n._start=this._rootSpan._end)}}}},{key:"_adjustStartToEarliestSpan",value:function(){var e,t,n=(e=this.spans,t=null,e.forEach(function(e){t||(t=e),t&&t._start>e._start&&(t=e)}),t);n&&n._start<this._rootSpan._start&&(this._rootSpan._start=n._start)}}]),e}();e.exports=a},function(e,t,n){"use strict";var r=n(6),i=n(0),o=[["domainLookupStart","domainLookupEnd","Domain lookup"],["connectStart","connectEnd","Making a connection to the server"],["requestStart","responseEnd","Requesting and receiving the document"],["domLoading","domInteractive","Parsing the document, executing sync. scripts"],["domContentLoadedEventStart","domContentLoadedEventEnd",'Fire "DOMContentLoaded" event'],["loadEventStart","loadEventEnd",'Fire "load" event']],a=3e5;function s(e,t){var n=t.duration();return n<a&&n>0&&t._start<=e._rootSpan._end&&t._end<=e._rootSpan._end}function c(e,t){for(var n=[],i=0;i<o.length;i++){var s=e[o[i][0]],c=e[o[i][1]];if(t&&s&&c&&c>s&&s>=t&&c-s<a&&s-t<a&&c-t<a){var u=new r(o[i][2],"hard-navigation.browser-timing");"requestStart"===o[i][0]&&(u.pageResponse=!0),u._start=s-t,u.ended=!0,u._end=c-t,n.push(u)}}return n}function u(e,t){for(var n=[],o=0;o<e.length;o++){var s=e[o];if((!s.initiatorType||"xmlhttprequest"!==s.initiatorType)&&s.name)if("css"!==s.initiatorType&&"img"!==s.initiatorType&&"script"!==s.initiatorType&&"link"!==s.initiatorType){for(var c=!1,u=0;u<t.length;u++){var f=s.name.lastIndexOf(t[u]);if(f>-1&&f===s.name.length-t[u].length){c=!0;break}}if(c)continue}else{var l="resource";s.initiatorType&&(l+="."+s.initiatorType);var d=s.startTime,p=s.responseEnd;if("number"==typeof d&&"number"==typeof p&&d>=0&&p>d&&p-d<a&&d<a&&p<a){var h=i.parseUrl(s.name),v=new r(h.path||s.name,l);v.setContext({http:{url:s.name}}),v._start=d,v.ended=!0,v._end=p,n.push(v)}}}return n}e.exports={captureHardNavigation:function(e){if(e.isHardNavigation&&window.performance&&window.performance.timing){var t=window.performance.timing.fetchStart,n=window.performance.timing;e._rootSpan._start=0,e.type="page-load",c(n,t).forEach(function(t){s(e,t)&&(t.traceId=e.traceId,t.sampled=e.sampled,e._options.pageLoadSpanId&&t.pageResponse&&(t.id=e._options.pageLoadSpanId),e.spans.push(t))}),window.performance.getEntriesByType&&u(window.performance.getEntriesByType("resource"),e.spans.filter(function(e){return e.type.indexOf("ext.HttpRequest")>-1}).map(function(e){return e.name.split(" ")[1]})).forEach(function(t){s(e,t)&&e.spans.push(t)}),e._adjustStartToEarliestSpan(),e._adjustEndToLatestSpan(),e.addNavigationTimingMarks()}},createNavigationTimingSpans:c,createResourceTimingSpans:u}},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=n(24),o=n(28),a=n(29),s=n(5),c=n(0),u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._serviceCreators={},this._serviceInstances={},this.initialized=!1}return r(e,[{key:"registerCoreServices",value:function(){var e=this;this.registerServiceCreator("ConfigService",function(){return new o}),this.registerServiceCreator("LoggingService",function(){return new a}),this.registerServiceCreator("ApmServer",function(){return new i(e.getService("ConfigService"),e.getService("LoggingService"))}),this.registerServiceInstance("PatchUtils",s),this.registerServiceInstance("Utils",c)}},{key:"init",value:function(){if(!this.initialized){this.initialized=!0;var e=this.getService("ConfigService");e.init();var t=this.getService("LoggingService");n(t,e),e.subscribeToChange(function(r){n(t,e)}),this.getService("ApmServer").init()}function n(e,t){!0===t.get("debug")&&"trace"!==t.config.logLevel?e.setLevel("debug",!1):e.setLevel(t.get("logLevel"),!1)}}},{key:"registerServiceCreator",value:function(e,t){this._serviceCreators[e]=t}},{key:"registerServiceInstance",value:function(e,t){this._serviceInstances[e]=t}},{key:"getService",value:function(e){if(!this._serviceInstances[e]){if("function"!=typeof this._serviceCreators[e])throw new Error("Can not get service, No creator for: "+e);this._serviceInstances[e]=this._serviceCreators[e](this)}return this._serviceInstances[e]}}]),e}();e.exports=u},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=n(25),o=n(26),a=n(0),s=n(27),c=n(4).XHR_IGNORE,u=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._configService=t,this._loggingService=n,this.logMessages={invalidConfig:{message:"Configuration is invalid!",level:"warn"}},this.errorQueue=void 0,this.transactionQueue=void 0,this.throttleAddError=void 0,this.throttleAddTransaction=void 0,this.initialized=!1,this.ndjsonSpan={}}return r(e,[{key:"init",value:function(){this.initialized||(this.initialized=!0,this.initErrorQueue(),this.initTransactionQueue())}},{key:"createServiceObject",value:function(){var e=this._configService,t=e.get("serverStringLimit");return{name:a.sanitizeString(e.get("serviceName"),t,!0),version:a.sanitizeString(e.get("serviceVersion"),t,!1),agent:{name:e.get("agentName"),version:e.get("agentVersion")},language:{name:"javascript"}}}},{key:"_postJson",value:function(e,t){return this._makeHttpRequest("POST",e,t,{"Content-Type":"application/x-ndjson"})}},{key:"_makeHttpRequest",value:function(e,t,n,r){return new Promise(function(i,o){var a=new window.XMLHttpRequest;if(a[c]=!0,a.open(e,t,!0),a.timeout=1e4,r)for(var s in r)r.hasOwnProperty(s)&&a.setRequestHeader(s,r[s]);a.onreadystatechange=function(e){if(4===a.readyState){var n=a.status;if(0===n||n>399&&n<600){var r=new Error(t+" HTTP status: "+n);r.xhr=a,o(r)}else i(a.responseText)}},a.onerror=function(e){o(e)},a.send(n)})}},{key:"_createQueue",value:function(e){var t=this._configService.get("queueLimit"),n=this._configService.get("flushInterval");return new i(e,{queueLimit:t,flushInterval:n})}},{key:"initErrorQueue",value:function(){var e=this;this.errorQueue&&this.errorQueue.flush(),this.errorQueue=this._createQueue(function(t){var n=e.sendErrors(t);n&&n.then(void 0,function(t){e._loggingService.warn("Failed sending errors!",t)})});var t=e._configService.get("errorThrottleLimit"),n=e._configService.get("errorThrottleInterval");this.throttleAddError=o(this.errorQueue.add.bind(this.errorQueue),function(t,n){e._loggingService.warn("Dropped error due to throttling!")},{limit:t,interval:n})}},{key:"initTransactionQueue",value:function(){var e=this;this.transactionQueue&&this.transactionQueue.flush(),this.transactionQueue=this._createQueue(function(t){var n=e.sendTransactions(t);n&&n.then(void 0,function(t){e._loggingService.warn("Failed sending transactions!",t)})});var t=e._configService.get("transactionThrottleLimit"),n=e._configService.get("transactionThrottleInterval");this.throttleAddTransaction=o(this.transactionQueue.add.bind(this.transactionQueue),function(){e._loggingService.warn("Dropped transaction due to throttling!")},{limit:t,interval:n})}},{key:"addError",value:function(e){this._configService.isActive()&&(this.errorQueue||this.initErrorQueue(),this.throttleAddError(e))}},{key:"addTransaction",value:function(e){this._configService.isActive()&&(this.transactionQueue||this.initTransactionQueue(),this.throttleAddTransaction(e))}},{key:"warnOnce",value:function(e){"warn"===e.level?(e.level="debug",this._loggingService.warn(e.message)):this._loggingService.debug(e.message)}},{key:"ndjsonErrors",value:function(e){return e.map(function(e){return s.stringify({error:e})})}},{key:"sendErrors",value:function(e){if(this._configService.isValid()&&this._configService.isActive()){if(e&&e.length>0){var t={service:this.createServiceObject(),errors:e};if(t=this._configService.applyFilters(t)){var n=this._configService.getEndpointUrl("errors"),r=this.ndjsonErrors(t.errors);r.unshift(s.stringify({metadata:{service:t.service}}));var i=r.join("");return this._postJson(n,i)}this._loggingService.warn("Dropped payload due to filtering!")}}else this.warnOnce(this.logMessages.invalidConfig)}},{key:"ndjsonTransactions",value:function(e){var t=this.ndjsonSpan;return e.map(function(e){var n="";return e.spans&&(n=e.spans.map(function(e){return t.span=e,s.stringify(t)}).join(""),delete e.spans),s.stringify({transaction:e})+n})}},{key:"sendTransactions",value:function(e){if(this._configService.isValid()&&this._configService.isActive()){if(e&&e.length>0){var t={service:this.createServiceObject(),transactions:e};if(t=this._configService.applyFilters(t)){var n=this._configService.getEndpointUrl("transactions"),r=this.ndjsonTransactions(t.transactions);r.unshift(s.stringify({metadata:{service:t.service}}));var i=r.join("");return this._postJson(n,i)}this._loggingService.warn("Dropped payload due to filtering!")}}else this.warnOnce(this.logMessages.invalidConfig)}}]),e}();e.exports=u},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n||(n={}),this.onFlush=t,this.items=[],this.queueLimit=n.queueLimit||-1,this.flushInterval=n.flushInterval||0,this.timeoutId=void 0}return r(e,[{key:"_setTimer",value:function(){var e=this;this.timeoutId=setTimeout(function(){e.flush()},this.flushInterval)}},{key:"flush",value:function(){this.onFlush(this.items),this._clear()}},{key:"_clear",value:function(){void 0!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0),this.items=[]}},{key:"add",value:function(e){this.items.push(e),-1!==this.queueLimit&&this.items.length>=this.queueLimit?this.flush():void 0===this.timeoutId&&this._setTimer()}}]),e}();e.exports=i},function(e,t,n){"use strict";e.exports=function(e,t,n){var r,i=n.context||this,o=n.limit,a=n.interval,s=n.countFn||function(){},c=0;return function(){var n="function"==typeof s&&s.apply(i,arguments);return"number"!=typeof n&&(n=1),c+=n,void 0===r&&(r=setTimeout(function(){c=0,r=void 0},a)),c>o?"function"==typeof t?t.apply(i,arguments):void 0:e.apply(i,arguments)}}},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"stringify",value:function(e){return JSON.stringify(e)+"\n"}}]),e}();e.exports=i},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(0),o=n(1);function a(){this.config={},this.defaults={serviceName:"",serviceVersion:"",agentName:"js-base",agentVersion:"1.0.0",serverUrl:"http://localhost:8200",serverUrlPrefix:"/intake/v2/rum/events",active:!0,isInstalled:!1,debug:!1,logLevel:"warn",browserResponsivenessInterval:500,browserResponsivenessBuffer:3,checkBrowserResponsiveness:!0,enable:!0,groupSimilarSpans:!0,similarSpanThreshold:.05,sendVerboseDebugInfo:!1,includeXHRQueryString:!1,capturePageLoad:!0,ignoreTransactions:[],errorThrottleLimit:20,errorThrottleInterval:3e4,transactionThrottleLimit:20,transactionThrottleInterval:3e4,transactionDurationThreshold:6e4,queueLimit:-1,flushInterval:500,sendPageLoadTransaction:!0,serverStringLimit:1024,distributedTracing:!0,distributedTracingOrigins:[],distributedTracingHeaderValueCallback:void 0,distributedTracingHeaderName:"elastic-apm-traceparent",pageLoadTraceId:void 0,pageLoadSpanId:void 0,pageLoadSampled:void 0,pageLoadTransactionName:void 0,transactionSampleRate:1,context:{},platform:{}},this._changeSubscription=new o,this.filters=[]}a.prototype.isActive=function(){return this.get("active")},a.prototype.addFilter=function(e){if("function"!=typeof e)throw new Error("Argument to must be function");this.filters.push(e)},a.prototype.applyFilters=function(e){for(var t=0;t<this.filters.length;t++)if(!(e=this.filters[t](e)))return;return e},a.prototype.init=function(){var e=s();this.setConfig(e)},a.prototype.get=function(e){return i.arrayReduce(e.split("."),function(e,t){return e&&e[t]},this.config)},a.prototype.getEndpointUrl=function(e){return this.get("serverUrl")+this.get("serverUrlPrefix")},a.prototype.set=function(e,t){var n=e.split("."),r=n.length-1,o=this.config;i.arraySome(n,function(e,n){if(void 0===e)return!0;if(n===r)o[e]=t;else{var i=o[e]||{};o[e]=i,o=i}})},a.prototype.setUserContext=function(e){var t={};"number"==typeof e.id&&(t.id=e.id),"string"==typeof e.id&&(t.id=i.sanitizeString(e.id,this.get("serverStringLimit"))),"string"==typeof e.username&&(t.username=i.sanitizeString(e.username,this.get("serverStringLimit"))),"string"==typeof e.email&&(t.email=i.sanitizeString(e.email,this.get("serverStringLimit"))),this.set("context.user",t)},a.prototype.setCustomContext=function(e){e&&"object"===(void 0===e?"undefined":r(e))&&this.set("context.custom",e)},a.prototype.setTag=function(e,t){if(!e)return!1;this.config.context.tags||(this.config.context.tags={});var n=e.replace(/[.*]/g,"_");this.config.context.tags[n]=i.sanitizeString(t,this.get("serverStringLimit"))},a.prototype.setTags=function(e){var t=this;Object.keys(e).forEach(function(n){t.setTag(n,e[n])})},a.prototype.getAgentName=function(){var e=this.config.agentVersion;return e||(e="dev"),this.get("agentName")+"/"+e},a.prototype.setConfig=function(e){e=e||{},this.config=i.merge({},this.defaults,this.config,e),this._changeSubscription.applyAll(this,[this.config])},a.prototype.subscribeToChange=function(e){return this._changeSubscription.subscribe(e)},a.prototype.isValid=function(){var e=i.arrayMap(["serviceName","serverUrl"],i.functionBind(function(e){return null===this.config[e]||void 0===this.config[e]||""===this.config[e]},this));return-1===i.arrayIndexOf(e,!0)};var s=function(){return function(e){var t={},n=/^data-([\w-]+)$/;if(e)for(var r=e.attributes,o=0;o<r.length;o++){var a=r[o];if(n.test(a.nodeName)){var s=a.nodeName.match(n)[1];s=i.arrayMap(s.split("-"),function(e,t){return t>0?e.charAt(0).toUpperCase()+e.substring(1):e}).join(""),t[s]=a.value||a.nodeValue}}return t}(i.getCurrentScript())};a.prototype.isPlatformSupported=function(){return"function"==typeof Array.prototype.forEach&&"function"==typeof JSON.stringify&&"function"==typeof Function.bind&&window.performance&&"function"==typeof window.performance.now&&i.isCORSSupported()},e.exports=a},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function i(){}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t||(t={}),this.levels=["trace","debug","info","warn","error"],this.level=t.level||"info",this.prefix=t.prefix||"",this.resetLogMethods()}return r(e,[{key:"shouldLog",value:function(e){return this.levels.indexOf(e)>=this.levels.indexOf(this.level)}},{key:"setLevel",value:function(e){this.level=e,this.resetLogMethods()}},{key:"resetLogMethods",value:function(){var e=this;this.levels.forEach(function(t){e[t]=e.shouldLog(t)?function(){var n,r=e.prefix;switch(t){case"trace":case"debug":n="info";break;default:n=t}var i=arguments;r&&("function"==typeof r&&(r=r(t)),i[0]=r+i[0]);if(console){var o=console[n]?console[n]:console.log;"function"==typeof o&&o.apply(console,i)}}:i})}}]),e}();e.exports=o},function(e,t,n){"use strict";e.exports=n(31).polyfill()},function(e,r,i){"use strict";var o,a,s,c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.4+314e4831
 */
s=function(){function e(e){return"function"==typeof e}var r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=0,o=void 0,a=void 0,s=function(e,t){v[i]=e,v[i+1]=t,2===(i+=2)&&(a?a(g):_())};var u="undefined"!=typeof window?window:void 0,f=u||{},l=f.MutationObserver||f.WebKitMutationObserver,d="undefined"==typeof self&&void 0!==n&&"[object process]"==={}.toString.call(n),p="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){var e=setTimeout;return function(){return e(g,1)}}var v=new Array(1e3);function g(){for(var e=0;e<i;e+=2){(0,v[e])(v[e+1]),v[e]=void 0,v[e+1]=void 0}i=0}var y,m,b,S,_=void 0;function w(e,t){var n=this,r=new this.constructor(x);void 0===r[k]&&U(r);var i=n._state;if(i){var o=arguments[i-1];s(function(){return q(i,r,o,n._result)})}else M(n,r,e,t);return r}function T(e){if(e&&"object"===(void 0===e?"undefined":c(e))&&e.constructor===this)return e;var t=new this(x);return A(t,e),t}d?_=function(){return n.nextTick(g)}:l?(m=0,b=new l(g),S=document.createTextNode(""),b.observe(S,{characterData:!0}),_=function(){S.data=m=++m%2}):p?((y=new MessageChannel).port1.onmessage=g,_=function(){return y.port2.postMessage(0)}):_=void 0===u?function(){try{var e=Function("return this")().require("vertx");return void 0!==(o=e.runOnLoop||e.runOnContext)?function(){o(g)}:h()}catch(e){return h()}}():h();var k=Math.random().toString(36).substring(2);function x(){}var E=void 0,C=1,L=2,O={error:null};function I(e){try{return e.then}catch(e){return O.error=e,O}}function N(t,n,r){n.constructor===t.constructor&&r===w&&n.constructor.resolve===T?function(e,t){t._state===C?P(e,t._result):t._state===L?F(e,t._result):M(t,void 0,function(t){return A(e,t)},function(t){return F(e,t)})}(t,n):r===O?(F(t,O.error),O.error=null):void 0===r?P(t,n):e(r)?function(e,t,n){s(function(e){var r=!1,i=function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}(n,t,function(n){r||(r=!0,t!==n?A(e,n):P(e,n))},function(t){r||(r=!0,F(e,t))},e._label);!r&&i&&(r=!0,F(e,i))},e)}(t,n,r):P(t,n)}function A(e,t){var n,r;e===t?F(e,new TypeError("You cannot resolve a promise with itself")):(r=void 0===(n=t)?"undefined":c(n),null===n||"object"!==r&&"function"!==r?P(e,t):N(e,t,I(t)))}function j(e){e._onerror&&e._onerror(e._result),R(e)}function P(e,t){e._state===E&&(e._result=t,e._state=C,0!==e._subscribers.length&&s(R,e))}function F(e,t){e._state===E&&(e._state=L,e._result=t,s(j,e))}function M(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+C]=n,i[o+L]=r,0===o&&e._state&&s(R,e)}function R(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,o=e._result,a=0;a<t.length;a+=3)r=t[a],i=t[a+n],r?q(n,r,i,o):i(o);e._subscribers.length=0}}function q(t,n,r,i){var o=e(r),a=void 0,s=void 0,c=void 0,u=void 0;if(o){if((a=function(e,t){try{return e(t)}catch(e){return O.error=e,O}}(r,i))===O?(u=!0,s=a.error,a.error=null):c=!0,n===a)return void F(n,new TypeError("A promises callback cannot return that same promise."))}else a=i,c=!0;n._state!==E||(o&&c?A(n,a):u?F(n,s):t===C?P(n,a):t===L&&F(n,a))}var H=0;function U(e){e[k]=H++,e._state=void 0,e._result=void 0,e._subscribers=[]}var D=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(x),this.promise[k]||U(this.promise),r(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?P(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&P(this.promise,this._result))):F(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===E&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===T){var i=I(e);if(i===w&&e._state!==E)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===z){var o=new n(x);N(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===E&&(this._remaining--,e===L?F(r,n):this._result[t]=n),0===this._remaining&&P(r,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;M(e,void 0,function(e){return n._settledAt(C,t,e)},function(e){return n._settledAt(L,t,e)})},e}();var z=function(){function e(t){this[k]=H++,this._result=this._state=void 0,this._subscribers=[],x!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t(function(t){A(e,t)},function(t){F(e,t)})}catch(t){F(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},e}();return z.prototype.then=w,z.all=function(e){return new D(this,e).promise},z.race=function(e){var t=this;return r(e)?new t(function(n,r){for(var i=e.length,o=0;o<i;o++)t.resolve(e[o]).then(n,r)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},z.resolve=T,z.reject=function(e){var t=new this(x);return F(t,e),t},z._setScheduler=function(e){a=e},z._setAsap=function(e){s=e},z._asap=s,z.polyfill=function(){var e=void 0;if(void 0!==t)e=t;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=e.Promise;if(n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(e){}if("[object Promise]"===r&&!n.cast)return}e.Promise=z},z.Promise=z,z},"object"===c(r)&&void 0!==e?e.exports=s():void 0===(a="function"==typeof(o=s)?o.call(r,i,r,e):o)||(e.exports=a)},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._disable=n,this.serviceFactory=t,this._initialized=!1}return r(e,[{key:"init",value:function(e){if(this.isEnabled()&&!this._initialized){this._initialized=!0;var t=this.serviceFactory.getService("ConfigService");t.setConfig({agentName:"js-base",agentVersion:"1.0.0"}),t.setConfig(e),this.serviceFactory.init(),this.serviceFactory.getService("ErrorLogging").registerGlobalEventListener(),this.serviceFactory.getService("PerformanceMonitoring").init(),t.get("sendPageLoadTransaction")&&this._sendPageLoadMetrics()}return this}},{key:"_sendPageLoadMetrics",value:function(){var e=this.serviceFactory.getService("TransactionService"),t=this.serviceFactory.getService("ConfigService"),n=e.startTransaction(t.get("pageLoadTransactionName"),"page-load"),r=function(){setTimeout(function(){n&&n.detectFinish()})};"complete"===document.readyState?r():window.addEventListener("load",r)}},{key:"isEnabled",value:function(){return!this._disable}},{key:"config",value:function(e){this.serviceFactory.getService("ConfigService").setConfig(e)}},{key:"setUserContext",value:function(e){this.serviceFactory.getService("ConfigService").setUserContext(e)}},{key:"setCustomContext",value:function(e){this.serviceFactory.getService("ConfigService").setCustomContext(e)}},{key:"setTags",value:function(e){this.serviceFactory.getService("ConfigService").setTags(e)}},{key:"setInitialPageLoadName",value:function(e){this.isEnabled()&&this.serviceFactory.getService("ConfigService").setConfig({pageLoadTransactionName:e})}},{key:"startTransaction",value:function(e,t){if(this.isEnabled())return this.serviceFactory.getService("TransactionService").startTransaction(e,t)}},{key:"startSpan",value:function(e,t){if(this.isEnabled())return this.serviceFactory.getService("TransactionService").startSpan(e,t)}},{key:"getCurrentTransaction",value:function(){if(this.isEnabled())return this.serviceFactory.getService("TransactionService").getCurrentTransaction()}},{key:"getTransactionService",value:function(){if(this.isEnabled())return this.serviceFactory.getService("TransactionService")}},{key:"captureError",value:function(e){if(this.isEnabled())return this.serviceFactory.getService("ErrorLogging").logError(e)}},{key:"addFilter",value:function(e){this.serviceFactory.getService("ConfigService").addFilter(e)}}]),e}();e.exports=i}])},e.exports=r()}).call(t,n(2),n(3))},function(e,t,n){n(0).init;var r=n(4)({active:Math.random()<1,debug:!0,serviceName:"apm-agent-js-base-test-e2e-general-usecase",serviceVersion:"0.0.1",distributedTracingOrigins:["http://localhost:8002"],pageLoadTraceId:"286ac3ad697892c406528f13c82e0ce1",pageLoadSpanId:"bbd8bcc3be14d814",pageLoadSampled:!0});function i(){throw new Error("timeout test error with a secret")}r.setInitialPageLoadName("general-usecase-initial-page-load"),r.setUserContext({usertest:"usertest",id:"userId",username:"username",email:"email"}),r.setCustomContext({testContext:"testContext"}),r.setTags({testTagKey:"testTagValue"}),r.addFilter(function(e){return e.errors&&e.errors.forEach(function(e){e.exception.message=e.exception.message.replace("secret","[REDACTED]")}),e.transactions&&e.transactions.forEach(function(e){e.spans.forEach(function(e){if(e.context&&e.context.http&&e.context.http.url){var t=new URL(e.context.http.url,window.location.origin);t.searchParams&&t.searchParams.get("token")&&t.searchParams.set("token","REDACTED"),e.context.http.url=t.toString()}})}),e}),setTimeout(function(){i()},100);var o=new window.XMLHttpRequest;o.open("GET","/test/e2e/common/data.json?test=hamid",!1),o.addEventListener("load",function(){console.log("got data!")}),o.send(),(o=new window.XMLHttpRequest).open("POST","http://localhost:8002/data",!1),o.addEventListener("load",function(){var e=JSON.parse(o.responseText);if(console.log("distributed tracing data",e),"string"!=typeof e.traceId)throw new Error("Wrong distributed tracing payload: "+o.responseText)}),o.send(),i.tmp="tmp";var a=document.getElementById("app"),s=document.createElement("h2");s.setAttribute("id","test-element"),s.innerHTML="Passed",a.appendChild(s)},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,u=[],f=!1,l=-1;function d(){f&&c&&(f=!1,c.length?u=c.concat(u):l=-1,u.length&&p())}function p(){if(!f){var e=s(d);f=!0;for(var t=u.length;t;){for(c=u,u=[];++l<t;)c&&c[l].run();l=-1,t=u.length}c=null,f=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new h(e,t)),1!==u.length||f||s(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){var r=n(0).init,i=n(0).apmBase,o=n(5);e.exports=function(e){window.globalConfigs||(window.globalConfigs={agentConfig:{serverUrl:"http://localhost:8200",serviceName:"apm-agent-js-base/test"},useMocks:!1,mockApmServer:!1,serverUrl:"http://localhost:8200",env:{}});var t,n=window.globalConfigs;console.log(n),t=i.serviceFactory.getService("ApmServer"),n.serverUrl&&(e.serverUrl=n.serverUrl);var a=new o(t,n.useMocks);return i.serviceFactory.registerServiceInstance("ApmServer",a),elasticApm=r(e),elasticApm}},function(e,t,n){var r=n(6);e.exports=class{constructor(e,t){var n=this.subscription=new r,i=this._apmServer=e,o=this.calls={};function a(e,t){o[e]?o[e].push(t):o[e]=[t],n.applyAll(this,[t])}function s(e,t,n){var r=e[t];return e[t]=function(){var i={args:Array.prototype.slice.call(arguments).map(e=>JSON.parse(JSON.stringify(e))),mocked:!1};return n?(i.mocked=!0,i.returnValue=n.apply(e,arguments),a(t,i),i.returnValue):(i.returnValue=r.apply(e,arguments),a(t,i),i.returnValue)}}s(i,"sendErrors",t?function(){return Promise.resolve()}:void 0),s(i,"sendTransactions",t?function(){return Promise.resolve()}:void 0),this.addError=i.addError.bind(i),this.addTransaction=i.addTransaction.bind(i)}init(){}}},function(e,t){function n(){this.subscriptions=[]}n.prototype.subscribe=function(e){var t=this;return this.subscriptions.push(e),function(){var n=t.subscriptions.indexOf(e);n>-1&&t.subscriptions.splice(n,1)}},n.prototype.applyAll=function(e,t){this.subscriptions.forEach(function(n){try{n.apply(e,t)}catch(e){console.log(e,e.stack)}},this)},e.exports=n}]);
//# sourceMappingURL=app.e2e-bundle.min.js.map